{#
    Renders pagination controls for search results.
    - total_pages: The total number of pages.
    - current_page: The current active page.
    - total_results: The total number of items found.
#}
{% if total_pages > 1 %}
<div class="pagination">
    <div class="pagination-summary">
        Showing {{ results|length }} of {{ total_results }} results
    </div>
    <div class="pagination-links">
        {# Previous Page Link #}
        {% if current_page > 1 %}
            {% set prev_args = request.args.to_dict() %}{% set _ = prev_args.update({'page': current_page - 1}) %}
            <a href="{{ url_for('search', **prev_args) }}">&laquo; Previous</a>
        {% else %}
            <span class="disabled">&laquo; Previous</span>
        {% endif %}

        {# Page Number Links with Ellipses for many pages #}
        {% set page_window = 2 %}
        {% for p in range(1, total_pages + 1) %}
            {% if p == 1 or p == total_pages or (p >= current_page - page_window and p <= current_page + page_window) %}
                {% if loop.previtem and p > loop.previtem + 1 %}
                    <span>...</span>
                {% endif %}
                {% if p == current_page %}
                    <span class="active">{{ p }}</span>
                {% else %}
                    {% set page_args = request.args.to_dict() %}{% set _ = page_args.update({'page': p}) %}
                    <a href="{{ url_for('search', **page_args) }}">{{ p }}</a>
                {% endif %}
            {% endif %}
        {% endfor %}

        {# Next Page Link #}
        {% if current_page < total_pages %}
            {% set next_args = request.args.to_dict() %}{% set _ = next_args.update({'page': current_page + 1}) %}
            <a href="{{ url_for('search', **next_args) }}">Next &raquo;</a>
        {% else %}
            <span class="disabled">Next &raquo;</span>
        {% endif %}
    </div>
</div>
{% endif %}